import java.awt.BorderLayout;
import java.awt.Color; // Importar Color
import java.io.BufferedReader;
import java.io.FileReader;
import java.io.IOException;
import java.util.HashMap;
import java.util.Map;

import javax.swing.JFrame;
import javax.swing.JPanel;

import org.jfree.chart.ChartFactory;
import org.jfree.chart.ChartPanel;
import org.jfree.chart.JFreeChart;
import org.jfree.chart.plot.CategoryPlot; // Importar CategoryPlot
import org.jfree.data.category.DefaultCategoryDataset;

public class Proyecto2 extends JFrame {

    private JPanel panel;

    public Proyecto2() {
        setSize(800, 600);
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        String ruta = "C:\\Users\\monts\\OneDrive\\Escritorio\\UAA\\Lenguajes de Computacion III\\DatosP2.txt";

        String line;
        Map<String, int[]> personas = new HashMap<>();

        try (BufferedReader br = new BufferedReader(new FileReader(ruta))) {
            while ((line = br.readLine()) != null) {
                String[] fila = line.split(",");
                String genero = fila[4];
                String estado = fila[5];

                personas.putIfAbsent(estado, new int[]{0, 0});

                // Incrementar conteo basado en el género
                if (genero.equals("H")) {
                    personas.get(estado)[0]++;
                } else if (genero.equals("M")) {
                    personas.get(estado)[1]++;
                }
            }
        } catch (IOException e) {
            System.out.println("Ocurrió un problema al leer el archivo: " + e.getMessage());
        }

        // Crear el conjunto de datos para el gráfico de barras
        DefaultCategoryDataset dataset = new DefaultCategoryDataset();
        
        for (String estado : personas.keySet()) {
            int[] counts = personas.get(estado);
            dataset.addValue(counts[0], "Hombres", estado);
            dataset.addValue(counts[1], "Mujeres", estado);
        }

        // Crear el gráfico de barras
        JFreeChart grafico = ChartFactory.createBarChart(
            "Cantidad de Hombres y Mujeres por Estado",
            "Estado",
            "Cantidad",
            dataset
        );

        // Modificar colores de las barras
        CategoryPlot plot = grafico.getCategoryPlot();
        plot.getRenderer().setSeriesPaint(0, Color.BLUE);  // Color azul para hombres
        plot.getRenderer().setSeriesPaint(1, Color.PINK);  // Color rosa para mujeres
        ChartPanel graficoPanel = new ChartPanel(grafico);
        graficoPanel.setPreferredSize(new java.awt.Dimension(800, 600));
        
        panel = new JPanel(new BorderLayout());
        panel.add(graficoPanel, BorderLayout.CENTER);
        
        add(panel);
    }

    public static void main(String[] args) {
        Proyecto2 ventana = new Proyecto2();
        ventana.setTitle("Proyecto 2");
        ventana.setVisible(true);
    }
}